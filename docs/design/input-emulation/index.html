<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-design/input-emulation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Input Emulation | Pod Arcade</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.pod-arcade.com/docs/design/input-emulation/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Input Emulation | Pod Arcade"><meta data-rh="true" name="description" content="The most crucial part to the Pod Arcade experience is getting input from the Browser to the Desktop. This page explains some of the challenges we faced when designing this system, and what Linux hacks we had to implement to make it work. This page assumes a basic understanding of how Linux handles input devices."><meta data-rh="true" property="og:description" content="The most crucial part to the Pod Arcade experience is getting input from the Browser to the Desktop. This page explains some of the challenges we faced when designing this system, and what Linux hacks we had to implement to make it work. This page assumes a basic understanding of how Linux handles input devices."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://www.pod-arcade.com/docs/design/input-emulation/"><link data-rh="true" rel="alternate" href="https://www.pod-arcade.com/docs/design/input-emulation/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.pod-arcade.com/docs/design/input-emulation/" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-85GEH9BR44"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-85GEH9BR44",{})</script><link rel="stylesheet" href="/assets/css/styles.4d403da2.css">
<script src="/assets/js/runtime~main.39f59460.js" defer="defer"></script>
<script src="/assets/js/main.dcf18e4d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-full.png" alt="Pod Arcade Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-full.png" alt="Pod Arcade Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro/">Documentation</a><a class="navbar__item navbar__link" href="/screenshots/">Screenshots</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/y8aasvEMy6" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link" aria-label="Discord"></a><a href="https://github.com/pod-arcade/pod-arcade" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://play.pod-arcade.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-cta">Play Now</a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/getting-started/">Getting Started</a><button aria-label="Collapse sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/docker/">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/helm/">Kubernetes (Helm)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/configuration/">Configuration</a><button aria-label="Collapse sidebar category &#x27;Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configuration/server/">Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configuration/desktop/">Desktop</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/guides/">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/session/">Session Page</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/design/">Design</a><button aria-label="Collapse sidebar category &#x27;Design&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/streaming/">Streaming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/design/input-emulation/">Input Emulation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/peer-to-peer/">Peer-to-Peer Connection</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/design/"><span itemprop="name">Design</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Input Emulation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Input Emulation</h1>
<p>The most crucial part to the Pod Arcade experience is getting input from the Browser to the Desktop. This page explains some of the challenges we faced when designing this system, and what Linux hacks we had to implement to make it work. This page assumes a basic understanding of how Linux handles input devices.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gamepad">Gamepad<a href="#gamepad" class="hash-link" aria-label="Direct link to Gamepad" title="Direct link to Gamepad">​</a></h2>
<p>One of the challenges that Pod Arcade had to overcome was the the creation of virtual gamepad devices inside of Docker, and expose them using the udev interface in Linux. Unfortunately, <code>uinput</code> and <code>udevd</code> aren&#x27;t container aware, so we can only do so much to keep things isolated to containers. While we are able to control device visibility inside of our containers, we aren&#x27;t able to prevent the host from seeing those virtual devices. As a result, it&#x27;s recommended that you only use this on a headless server, not a workstation.</p>
<p>This code aims to utilize the same <code>uinput</code> and <code>udev</code> APIs to work with existing software for discovering these virtual gamepads.</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-connect">1. Connect<a href="#1-connect" class="hash-link" aria-label="Direct link to 1. Connect" title="Direct link to 1. Connect">​</a></h3>
<p>Our application starts up, and opens a connection to the Kernel. This connection will be used to receive events when devices are created. The reason we need this, is that we can&#x27;t simply emit events directly without knowing the device information assigned by the Kernel. As far as I know, the only way of receiving this information is to listen for those Kevents sent by the kernel. Opening this socket looks like this:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  KernelEvent Mode </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  UdevEvent Mode </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Fd</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">Socket</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AF_NETLINK</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SOCK_RAW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">NETLINK_KOBJECT_UEVENT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Addr </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SockaddrNetlink</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  Family</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AF_NETLINK</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  Groups</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">uint32</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">mode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Mode determines the group, Kernel or Udev</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">Bind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Fd</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Addr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(212, 212, 212)">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  syscall</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">Close</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Fd</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#9CDCFE"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Crucially, one other thing that we need to do is create the <code>/run/udev</code> directory, and create a <code>/run/udev/control</code> file. These files aren&#x27;t used for anything, but the libudev library checks for the existence of these files to ensure that an instance of udev is running. It never reads to or writes to this file, only checks for its existence before subscribing to udev events.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-connect-application-side">2. Connect (Application Side)<a href="#2-connect-application-side" class="hash-link" aria-label="Direct link to 2. Connect (Application Side)" title="Direct link to 2. Connect (Application Side)">​</a></h3>
<p>Similar to how we subscribe to the Kernel group to receive device events over the netlink socket, applications normally subscribe to the Udev group.</p>
<p>Udevd is the userspace program that typically listens to these events from the kernel, enriches them with information from a hardware database, and re-emits them. It also has a set of rules that it executes when messages from the kernel match a set of filters. These rules can be used to do things like run a program that calibrates the joystick device, or other various things that don&#x27;t have a direct subscription to Udev. Applications typically subscribe to this using <code>libudev</code>, which is a library used for interacting with the userspace daemon.</p>
<p>In our case, we&#x27;re aiming to replace much of this userspace program&#x27;s functionality. We have to do some trickery in order to get <code>libudev</code> to actually believe that there&#x27;s a running udev instance and make the subscription. We do this by <code>touch</code>ing the <code>/run/udev/control</code> file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-create-a-gamepad-using-devuinput">3. Create a gamepad using /dev/uinput<a href="#3-create-a-gamepad-using-devuinput" class="hash-link" aria-label="Direct link to 3. Create a gamepad using /dev/uinput" title="Direct link to 3. Create a gamepad using /dev/uinput">​</a></h3>
<p>The /dev/uinput interface serves as a user-space API for creating and managing input devices at the kernel level. In essence, it enables you to create virtual input devices such as keyboards, mice, joysticks, or gamepads that the operating system treats as actual hardware devices. In order to use this interface, we need to bind through the host&#x27;s interface.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This isn&#x27;t technically true. We can use mknod to recreate the /dev/uinput file, as long as we have the major<!-- -->:minor<!-- --> version supplied by the kernel, but mounting it through is the easiest way. <code>c10:223</code> is what the device was on my machine, but I&#x27;m not sure if it&#x27;s the same for everyone. <code>stat --format=&quot;%t %T&quot; /dev/uinput</code> should give you the device numbers <strong>in hexadecimal format</strong></p></div></div>
<p>Regardless, by writing ioctl commands to this device, we can create a Virtual Gamepad.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-kernel--load-gamepad-driver-and-populate-sys-directory">4. Kernel — Load gamepad driver and populate /sys directory<a href="#4-kernel--load-gamepad-driver-and-populate-sys-directory" class="hash-link" aria-label="Direct link to 4. Kernel — Load gamepad driver and populate /sys directory" title="Direct link to 4. Kernel — Load gamepad driver and populate /sys directory">​</a></h3>
<p>The Kernel takes those ioctl commands, and loads the appropriate input driver. I&#x27;m not sure exactly how all of that happens, but it then creates the /sys directory entry for that device, in <code>/sys/devices/virtual/input/</code>. Unfortunately, this stage is <strong><em>NOT</em></strong> restricted to your container. The /sys entry is created in every container, and on the host. Additionally, the events emitted in the next step are also emitted to everyone. This means that if your host is running <code>udevd</code> (which it likely is), those virtual devices will show up on your host. We&#x27;re investigating ways of preventing this, but for now... virtual devices created in your container will show up on the host as well.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-broadcast-kevent">5. Broadcast Kevent<a href="#5-broadcast-kevent" class="hash-link" aria-label="Direct link to 5. Broadcast Kevent" title="Direct link to 5. Broadcast Kevent">​</a></h3>
<p>When a device is connected, the kernel writes a message that looks something like this over the netlink socket we&#x27;re subscribed to.
It&#x27;s a series of strings that represents device information. It always begins with a header that sigals what the <code>ACTION</code> is and on what <code>DEVPATH</code> it occurs on.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">add@/class/input/input9/mouse2\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ACTION=add\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DEVPATH=/class/input/input9/mouse2\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SUBSYSTEM=input\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SEQNUM=1064\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">PHYSDEVPATH=/devices/pci0000:00/0000:00:1d.1/usb2/2­2/2­2:1.0\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">PHYSDEVBUS=usb\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">PHYSDEVDRIVER=usbhid\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MAJOR=13\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MINOR=34\0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-receive-device-created-kevent">6. Receive device created Kevent<a href="#6-receive-device-created-kevent" class="hash-link" aria-label="Direct link to 6. Receive device created Kevent" title="Direct link to 6. Receive device created Kevent">​</a></h3>
<p>Our application receives and parses the message sent from the kernel. This gets it ready for step 7.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-map-device-to-a-local-path">7. Map device to a local path<a href="#7-map-device-to-a-local-path" class="hash-link" aria-label="Direct link to 7. Map device to a local path" title="Direct link to 7. Map device to a local path">​</a></h3>
<p>Now that we have the device major and minor number, we can map this to a file in our container. When determining if we should process a message from the given <code>&lt;DEVNAME&gt;</code>, we compare it to the syspath queried using <code>ioctl</code> for our gamepad.</p>
<p>Because we may have multiple containers, the event for one of our virtual gamepads may come in looking like: <code>add@/devices/virtual/input/input378/js4</code>. Unfortunately, some legacy applications don&#x27;t look for gamepad devices beyond <code>js0-3</code>. This isn&#x27;t as much of a problem with programs that use the new <code>libevdev</code> devices, but for older ones, they won&#x27;t detect the newly plugged in gamepad. Instead, we map this js4 device back to js0 for our container. This doesn&#x27;t affect the path assigned by the Kernel, but any further events emitted from our application will now use the mapped <code>js0-3</code>.</p>
<p>Additionally, we need to map not just the legacy <code>jsX</code> devices, but also the <code>eventXYZ</code> devices. If it&#x27;s the <code>eventXYZ</code>, we don&#x27;t make any changes and map the device as is.</p>
<p>If we find a match, we know that the device belongs to us. If it&#x27;s a legacy <code>jsX</code> device, we&#x27;ll map it to it&#x27;s index in our gamepad hub. Both of these devices are mapped to <code>/dev/input/js0-3</code>, or <code>/dev/input/eventXYZ</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-call-mknod-with-the-devices-major-and-minor-version">8. Call mknod with the device&#x27;s major and minor version<a href="#8-call-mknod-with-the-devices-major-and-minor-version" class="hash-link" aria-label="Direct link to 8. Call mknod with the device&#x27;s major and minor version" title="Direct link to 8. Call mknod with the device&#x27;s major and minor version">​</a></h3>
<p>Once we&#x27;ve mapped it to the desired path, we&#x27;ll make syscalls equivalent to <code>mknod c &lt;major&gt; &lt;minor&gt; /dev/input/jsX</code> and <code>mknod c &lt;major&gt; &lt;minor&gt; /dev/input/eventXYZ</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-resend-the-kernels-event-as-a-udev-event">9. Resend the Kernel&#x27;s event as a Udev event<a href="#9-resend-the-kernels-event-as-a-udev-event" class="hash-link" aria-label="Direct link to 9. Resend the Kernel&#x27;s event as a Udev event" title="Direct link to 9. Resend the Kernel&#x27;s event as a Udev event">​</a></h3>
<p>After we create the local device path using mknod, we can modify and resend the events using the udev format. This is an internal format used only by udevd and libudev. The format of this additional message looks something like this:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// C code taken from device-monitor.c</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">monitor_netlink_header</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">/* &quot;libudev&quot; prefix to distinguish libudev and kernel messages */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> prefix</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">/* Magic to protect against daemon &lt;-&gt; Library message format mismatch</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    * Used in the kernel from socket filter rules; needs to be stored in network order */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> magic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">/* Total length of header structure known to the sender */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> header_size</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">/* Properties string buffer */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> properties_off</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> properties_len</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">/* Hashes of primary device properties strings, to let libudev subscribers</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    * use in-kernel socket filters; values need to be stored in network order */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> filter_subsystem_hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> filter_devtype_hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> filter_tag_bloom_hi</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">unsigned</span><span class="token plain"> filter_tag_bloom_lo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> monitor_netlink_header</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">8 bytes of &quot;libudev&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">4 bytes of 0xfeedcafe</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">4 bytes of header size</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">X bytes of header</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">ACTION=add\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">DEVPATH=/class/input/input9/mouse2\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SUBSYSTEM=input\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">SEQNUM=1064\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">PHYSDEVPATH=/devices/pci0000:00/0000:00:1d.1/usb2/2­2/2­2:1.0\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">PHYSDEVBUS=usb\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">PHYSDEVDRIVER=usbhid\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MAJOR=13\0</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MINOR=34\0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-application-receives-a-notification-from-udevd">10. Application Receives a notification from &quot;udevd&quot;<a href="#10-application-receives-a-notification-from-udevd" class="hash-link" aria-label="Direct link to 10. Application Receives a notification from &quot;udevd&quot;" title="Direct link to 10. Application Receives a notification from &quot;udevd&quot;">​</a></h3>
<p>Now that we&#x27;ve forged our udev message, the application subscribed should receive it, and treat it as though it was a real message emitted from udevd.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-application-opens-virtual-device">11. Application opens virtual device<a href="#11-application-opens-virtual-device" class="hash-link" aria-label="Direct link to 11. Application opens virtual device" title="Direct link to 11. Application opens virtual device">​</a></h3>
<p>From the DEVPATH extracted from the received message, the corresponding <code>libevdev</code> or legacy uapi <code>joystick</code> library. Once connected to that device, the application should be able to use it as normal.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="keyboard--mouse">Keyboard / Mouse<a href="#keyboard--mouse" class="hash-link" aria-label="Direct link to Keyboard / Mouse" title="Direct link to Keyboard / Mouse">​</a></h2>
<p>Keyboard and mouse emulation, instead of being done through udev devices in the linux kernel, is done through wl-roots APIs directly. This is because the linux kernel doesn&#x27;t have a concept of a virtual keyboard or mouse, and instead relies on the compositor to handle these events. If we were to emulate a keyboard or mouse using udev, these devices may inadvertently be used by a shell that is running on the headless server, and may cause unintended side effects.</p>
<p>Instead, we use the <a href="https://wayland.app/protocols/virtual-keyboard-unstable-v1" target="_blank" rel="noopener noreferrer">virtual-keyboard-unstable-v1</a> and <a href="https://wayland.app/protocols/wlr-virtual-pointer-unstable-v1" target="_blank" rel="noopener noreferrer">wlr-virtual-pointer-unstable-v1</a> interfaces provided by wl-roots (and therefore Sway). These protocols are described using XML documents and are used to generate code to interact with the compositor. This code is generated by <a href="https://github.com/rajveermalviya/go-wayland/" target="_blank" rel="noopener noreferrer">https://github.com/rajveermalviya/go-wayland/</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="helpful-references">Helpful References<a href="#helpful-references" class="hash-link" aria-label="Direct link to Helpful References" title="Direct link to Helpful References">​</a></h2>
<ul>
<li><a href="https://documentation.suse.com/sles/12-SP5/html/SLES-all/cha-udev.html" target="_blank" rel="noopener noreferrer">https://documentation.suse.com/sles/12-SP5/html/SLES-all/cha-udev.html</a></li>
<li><a href="https://insujang.github.io/2018-11-27/udev-device-manager-for-the-linux-kernel-in-userspace/" target="_blank" rel="noopener noreferrer">https://insujang.github.io/2018-11-27/udev-device-manager-for-the-linux-kernel-in-userspace/</a></li>
<li><a href="https://github.com/systemd/systemd/blob/main/src/libudev/libudev-monitor.c" target="_blank" rel="noopener noreferrer">https://github.com/systemd/systemd/blob/main/src/libudev/libudev-monitor.c</a></li>
<li><a href="https://github.com/pilebones/go-udev" target="_blank" rel="noopener noreferrer">https://github.com/pilebones/go-udev</a></li>
<li><a href="https://docs.voidlinux.org/config/session-management.html" target="_blank" rel="noopener noreferrer">https://docs.voidlinux.org/config/session-management.html</a></li>
<li><a href="https://www.freedesktop.org/wiki/Software/systemd/multiseat/" target="_blank" rel="noopener noreferrer">https://www.freedesktop.org/wiki/Software/systemd/multiseat/</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/pod-arcade/website/tree/main/docs/design/input-emulation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/design/streaming/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Streaming</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/design/peer-to-peer/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Peer-to-Peer Connection</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#gamepad" class="table-of-contents__link toc-highlight">Gamepad</a><ul><li><a href="#1-connect" class="table-of-contents__link toc-highlight">1. Connect</a></li><li><a href="#2-connect-application-side" class="table-of-contents__link toc-highlight">2. Connect (Application Side)</a></li><li><a href="#3-create-a-gamepad-using-devuinput" class="table-of-contents__link toc-highlight">3. Create a gamepad using /dev/uinput</a></li><li><a href="#4-kernel--load-gamepad-driver-and-populate-sys-directory" class="table-of-contents__link toc-highlight">4. Kernel — Load gamepad driver and populate /sys directory</a></li><li><a href="#5-broadcast-kevent" class="table-of-contents__link toc-highlight">5. Broadcast Kevent</a></li><li><a href="#6-receive-device-created-kevent" class="table-of-contents__link toc-highlight">6. Receive device created Kevent</a></li><li><a href="#7-map-device-to-a-local-path" class="table-of-contents__link toc-highlight">7. Map device to a local path</a></li><li><a href="#8-call-mknod-with-the-devices-major-and-minor-version" class="table-of-contents__link toc-highlight">8. Call mknod with the device&#39;s major and minor version</a></li><li><a href="#9-resend-the-kernels-event-as-a-udev-event" class="table-of-contents__link toc-highlight">9. Resend the Kernel&#39;s event as a Udev event</a></li><li><a href="#10-application-receives-a-notification-from-udevd" class="table-of-contents__link toc-highlight">10. Application Receives a notification from &quot;udevd&quot;</a></li><li><a href="#11-application-opens-virtual-device" class="table-of-contents__link toc-highlight">11. Application opens virtual device</a></li></ul></li><li><a href="#keyboard--mouse" class="table-of-contents__link toc-highlight">Keyboard / Mouse</a></li><li><a href="#helpful-references" class="table-of-contents__link toc-highlight">Helpful References</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/configuration/">Configuration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/design/">Design</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/y8aasvEMy6" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/pod-arcade" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.patreon.com/PodArcade" target="_blank" rel="noopener noreferrer" class="footer__link-item">Patreon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Who we are</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about/">About Us</a></li><li class="footer__item"><a class="footer__link-item" href="/community/">Community Guidelines</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy/">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Pod Arcade. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>